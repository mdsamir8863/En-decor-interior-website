jQuery(function(t) {
    var a = !1,
        e = !1;

    function i(i) {
        i.preventDefault();
        var r, n = "on";
        t(i.target).hasClass("dmach-loadmore") ? r = t(i.target) : (r = t(".divi-filter-archive-loop.main-loop").closest(".filtered-posts-cont"), n = "off");
        var o = r.parent().find(".divi-filter-archive-loop"),
            l = o.attr("data-layoutid"),
            d = o.attr("data-posttype"),
            s = o.attr("data-noresults"),
            c = o.attr("data-sortorder"),
            p = o.attr("data-sortasc"),
            f = o.attr("data-gridstyle"),
            m = o.attr("data-columnscount"),
            u = o.attr("data-postnumber"),
            v = o.attr("data-btntext"),
            h = o.attr("data-btntext_loading"),
            g = o.attr("data-resultcount"),
            y = o.attr("data-countposition"),
            w = parseInt(o.attr("data-current-page")),
            $ = (parseInt(o.attr("data-max-page")), o.attr("data-filter-var")),
            x = o.find(".divi-loadmore").attr("data-icon"),
            b = o.attr("data-has-map"),
            k = o.attr("data-hide-marker-label"),
            j = o.attr("data-map-selector"),
            C = o.attr("data-map-marker-layout"),
            q = o.attr("data-map-all-posts"),
            L = o.attr("data-map-cluster"),
            _ = o.attr("data-link_wholegrid"),
            P = o.attr("data-wholegrid-external"),
            S = o.attr("data-wholegrid-external_acf"),
            z = {
                action: "divi_filter_loadmore_ajax_handler",
                security: loadmore_ajax_object.security,
                query: $,
                page: w,
                layoutid: l,
                posttype: d,
                noresults: s,
                sortorder: c,
                sortasc: p,
                gridstyle: f,
                columnscount: m,
                resultcount: g,
                countposition: y,
                postnumber: u,
                loadmoretext: v,
                loadmore_icon: x,
                link_wholegrid: _,
                link_wholegrid_external: P,
                link_wholegrid_external_acf: S,
                is_loadmore: n,
                has_map: b,
                map_all_posts: q,
                map_selector: j,
                marker_layout: C
            };
        "none" == l && (z.show_rating = o.attr("data-show_rating"), z.show_price = o.attr("data-show_price"), z.show_excerpt = o.attr("data-show_excerpt"), z.show_add_to_cart = o.attr("data-show_add_to_cart")), t.ajax({
            url: loadmore_ajax_object.ajax_url,
            data: z,
            type: "POST",
            beforeSend: function(t) {
                if ("on" == n) r.text(h);
                else {
                    var a = jQuery(".filtered-posts-cont").attr("data-ajaxload-anim");
                    r.parent().append('<div class="loadmore-ajax-loading ' + a + '"><div class="lines"><div class="line"></div><div class="line"></div><div class="line"></div></div><div class="spinner donut-cont"><div class="donut"></div></div><div class="spinner donutmulti-cont"><div class="donut multi"></div></div><div class="spinner ripple-cont"><div class="ripple"></div></div></div>')
                }
                o.closest(".filtered-posts-cont").find(".filtered-posts-loading").prepend('<div class="ajax-loading"><div class="lines"><div class="line"></div><div class="line"></div><div class="line"></div></div><div class="spinner donut-cont"><div class="donut"></div></div><div class="spinner donutmulti-cont"><div class="donut multi"></div></div><div class="spinner ripple-cont"><div class="ripple"></div></div></div>')
            },
            success: function(i) {
                if (a = !1, i) {
                    var n = t(i.posts);
                    r.hasClass("dmach-loadmore") ? r.text(v.replace(/\\/g, "")) : (r.parent().find(".loading").remove(), r.parent().find(".loadmore-ajax-loading").remove()), r.parent().find(".loop-grid").length > 0 ? r.parent().find(".loop-grid").eq(0).append(n) : r.parent().find("ul.products").length > 0 && r.parent().find("ul.products").eq(0).append(n), r.parent().find(".divi-filter-archive-loop").append(i.css_output), o.closest(".filtered-posts-cont").find(".filtered-posts-loading").find(".ajax-loading").remove();
                    var l = r.parent();
                    if (l.find(".divi-filter-result-count").length > 0 && l.find(".divi-filter-result-count").remove(), i.bc_result_count && r.parent().find(".woocommerce-result-count").length > 0 && r.parent().find(".woocommerce-result-count").html(i.bc_result_count), r.hasClass("dmach-loadmore") && r.remove(), i.after_post) {
                        var d = t("<textarea />").html(i.after_post).text();
                        l.append(d.replace(/\\/g, ""))
                    }
                    if (jQuery(".single_add_to_cart_button").addClass("ajax_add_to_cart"), "undefined" != typeof ajax_disabled_products_class && t("." + ajax_disabled_products_class + " .single_add_to_cart_button").removeClass("ajax_add_to_cart"), o.attr("data-current-page", w + 1), "function" == typeof resizeAllGridItems) {
                        var s = n.find("img").length;
                        n.find("img").one("load", function() {
                            --s <= 0 && resizeAllGridItems()
                        }).each(function() {
                            this.complete && jQuery(this).trigger("load")
                        })
                    }
                    if ("function" == typeof get_post_popup && get_post_popup(), o.find(".grid-col").find(".gallery_vars").length > 0) {
                        var c = o.find(".grid-col").find(".gallery_vars").attr("data-gallery_vars"),
                            p = o.find(".grid-col").find(".gallery_vars").attr("data-gallery_type");
                        if (c = JSON.parse(c = "{" + (c = (c = (c = c.replace(/,\s*$/, "")).replace(/,/g, ", ")).replace(/'/g, '"')) + "}"), jQuery(".et_pb_de_mach_acf_slider_containter").each(function(t, a) {
                                jQuery(this).hasClass("slick-initialized") && jQuery(this).slick("unslick"), jQuery(this).slick(c)
                            }), "gallery" == p) {
                            var m = o.find(".grid-col").find(".gallery_vars").attr("data-gallery_nav");
                            (m = JSON.parse(m = "{" + (m = (m = (m = m.replace(/,\s*$/, "")).replace(/,/g, ", ")).replace(/'/g, '"')) + "}")).asNavFor = ".et_pb_de_mach_acf_slider_containter", m.focusOnSelect = !0, jQuery(".et_pb_de_mach_acf_slider_containter_nav").each(function(t, a) {
                                jQuery(this).hasClass("slick-initialized") && jQuery(this).slick("unslick"), jQuery(this).slick(m)
                            })
                        }
                    }
                    if (i.map_data && jQuery(j).length > 0 && "off" == q && jQuery(j).each(function() {
                            jQuery(this);
                            var t = jQuery(this).data("map");
                            for (let a = 0; a < markers.length; a++) markers[a].setMap(null);
                            markers = [], "on" != L ? (jQuery.each(i.map_data, function(t, a) {
                                locations.push({
                                    lat: a.lat,
                                    lng: a.lng
                                }), void 0 !== k && "on" == k ? labels.push(a.title.charAt(0)) : labels.push(""), i_windows.push(a.infoview)
                            }), void 0 !== t && (markers = locations.map((a, e) => {
                                var i = new google.maps.Marker({
                                        position: a,
                                        label: labels[e],
                                        map: t
                                    }),
                                    r = new google.maps.InfoWindow({
                                        content: i_windows[e]
                                    });
                                return google.maps.event.addListener(t, "click", function() {
                                    r.close()
                                }), google.maps.event.addListener(i, "click", function() {
                                    r.open(t, i)
                                }), i
                            }))) : (jQuery.each(i.map_data, function(t, a) {
                                locations.push({
                                    lat: a.lat,
                                    lng: a.lng
                                }), void 0 !== k && "on" == k ? labels.push(a.title.charAt(0)) : labels.push(""), i_windows.push(a.infoview)
                            }), void 0 !== t && (markers = locations.map((a, e) => {
                                var i = new google.maps.Marker({
                                        position: a,
                                        label: labels[e]
                                    }),
                                    r = new google.maps.InfoWindow({
                                        content: i_windows[e]
                                    });
                                return google.maps.event.addListener(t, "click", function() {
                                    r.close()
                                }), google.maps.event.addListener(i, "click", function() {
                                    r.open(t, i)
                                }), i
                            }), new MarkerClusterer(t, markers, {
                                imagePath: clusterer_obj.imgPath
                            })))
                        }), "masonry" == f && "function" == typeof resizeAllGridItems) {
                        var u = o.attr("data-masonry_ajax_buffer");
                        resizeAllGridItems();
                        var s = jQuery(".divi-filter-archive-loop.main-loop").children().eq(0).find("img").length;
                        jQuery(".divi-filter-archive-loop.main-loop").children().eq(0).find("img").one("load", function() {
                            0 == --s && resizeAllGridItems()
                        }).each(function() {
                            this.complete && jQuery(this).trigger("load")
                        }), setTimeout(function() {
                            resizeAllGridItems()
                        }, u)
                    }
                    jQuery.fn.fitVids && jQuery("#main-content").fitVids({
                        customSelector: "iframe[src^='http://www.hulu.com'], iframe[src^='http://www.dailymotion.com'], iframe[src^='http://www.funnyordie.com'], iframe[src^='https://embed-ssl.ted.com'], iframe[src^='http://embed.revision3.com'], iframe[src^='https://flickr.com'], iframe[src^='http://blip.tv'], iframe[src^='http://www.collegehumor.com']"
                    }), o.find(".et_post_gallery").length > 0 && (o.find(".et_post_gallery").each(function() {
                        jQuery(this).magnificPopup({
                            delegate: ".et_pb_gallery_image a",
                            type: "image",
                            removalDelay: 500,
                            gallery: {
                                enabled: !0,
                                navigateByImgClick: !0
                            },
                            mainClass: "mfp-fade",
                            zoom: {
                                enabled: window.et_pb_custom && !window.et_pb_custom.is_builder_plugin_used,
                                duration: 500,
                                opener: function(t) {
                                    return t.find("img")
                                }
                            },
                            autoFocusLast: !1
                        })
                    }), o.find(".et_post_gallery").find("a").off("click")), jQuery.event.trigger({
                        type: "divi_filter_completed"
                    }), "" == i.posts && (e = !0)
                } else r.hasClass("dmach-loadmore") && r.remove()
            }
        })
    }
    t(document).on("click", ".dmach-loadmore", function(t) {
        i(t)
    }), "infinite" == t(".divi-filter-archive-loop.main-loop").data("loadmore") && t(window).scroll(function(r) {
        var n = t(".divi-filter-archive-loop.main-loop"),
            o = n.offset();
        parseInt(n.attr("data-current-page")) < parseInt(n.attr("data-max-page")) && t(window).scrollTop() > o.top + n.outerHeight(!0) - t(window).height() && !a && !e && (a = !0, i(r))
    })
});